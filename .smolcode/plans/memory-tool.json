{
  "id": "memory-tool",
  "steps": [
    {
      "id": "update-create-memory-tool",
      "description": "Update `tool_create_memory.go` to use the `memory.MemoryManager` for adding facts.",
      "status": "TODO",
      "acceptance": [
        "`tool_create_memory.go` imports the `github.com/dhamidi/smolcode/memory` package.",
        "The `createMemory` function initializes a `memory.New(memoryDBPath)` where `memoryDBPath` is `\".smolcode/memory.db\"`.",
        "The function iterates through the input facts and calls `mgr.AddMemory(id, content)` for each.",
        "File system operations like `os.MkdirAll`, `os.Stat`, `os.WriteFile` related to `.smolcode/facts` are removed from this tool.",
        "The response structure indicating added/updated is maintained if possible, or adapted if the `AddMemory` semantics (upsert) make it simpler (e.g., just a list of processed IDs)."
      ]
    },
    {
      "id": "update-recall-memory-tool",
      "description": "Update `tool_recall_memory.go` to use the `memory.MemoryManager` for recalling facts.",
      "status": "TODO",
      "acceptance": [
        "`tool_recall_memory.go` imports the `github.com/dhamidi/smolcode/memory` package.",
        "The `recallMemory` function initializes a `memory.New(memoryDBPath)`.",
        "If `factID` is provided, it calls `mgr.GetMemoryByID(factID)`.",
        "If `about` is provided, it calls `mgr.SearchMemory(about)`.",
        "The direct use of `os.ReadFile` for specific fact IDs and `os/exec` for `rg` (ripgrep) is removed.",
        "The response structure is updated to match the output of `GetMemoryByID` (single fact) or `SearchMemory` (list of matching facts)."
      ]
    },
    {
      "id": "verify-tool-definitions",
      "description": "Ensure the `genai.FunctionDeclaration` parameters and descriptions in both tool files still accurately reflect the updated functionality.",
      "status": "TODO",
      "acceptance": [
        "The description for `create_memory` is updated to reflect storage via the memory manager, not direct file writes, if necessary.",
        "The description for `recall_memory` is updated to reflect search via the memory manager, not `rg`, if necessary.",
        "Parameter descriptions are checked for accuracy."
      ]
    },
    {
      "id": "build-and-test",
      "description": "Build the application and run the `memory test` subcommand to ensure the changes are working correctly.",
      "status": "TODO",
      "acceptance": [
        "The application builds successfully using the remembered build command (`go build -tags fts5 -o smolcode cmd/smolcode/main.go`).",
        "The `./smolcode memory test` command completes successfully."
      ]
    }
  ]
}